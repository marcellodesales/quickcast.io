$(function(){$("video").quickCastPlayer(),$("a.embed").on("click",function(){if(0===$("a.embed textarea").length){$("a.embed span").hide();var e=$(this).attr("data-width"),t=$(this).attr("data-height"),n=parseFloat(e/t);e>300&&t>300?$(this).append("<textarea><iframe name='quickcast' src='http://"+window.location.host+"/embed"+window.location.pathname+"' scrolling='no' frameborder='0' width='100%' allowfullscreen></iframe><script>!function(){function n(){var n=document.getElementsByName('quickcast')\nfor(var e in n){var t=n[e].offsetWidth\nn[e].height=t/"+n.toFixed(2)+"+'px'}}n(),window.onresize=n,window.addEventListener('message',function(n){if(n.data.indexOf('//quick.as/') != -1)window.location.href=n.data},!1)}()\n</script></textarea>"):$(this).append("<textarea><iframe name='quickcast' src='http://"+window.location.host+"/embed"+window.location.pathname+"' scrolling='no' frameborder='0' width='"+e+"' height='"+t+"' allowfullscreen></iframe></textarea>")}return!1})}),function(e){e.fn.quickCastPlayer=function(){var t=e("video").attr("data-width"),n=e("video").attr("data-height"),i=parseFloat(t/n),a=e(".video").width(),s=["It's all about speed. Hot, nasty, badass speed &mdash; Will Ferell","Life moves pretty fast. If you don't stop and look around once in a while, you could miss it &mdash; Ferris Bueller","I'm too fast. I'm too smart. I'm too pretty &mdash; Muhammed Ali","Speed, it seems to me, provides the one genuinely modern pleasure &mdash; Aldous Huxley"];if(e("body.loading div.loader p").html(s[Math.floor(Math.random()*s.length)]),/mobile/i.test(navigator.userAgent)){var o=e("body").width();return e("video").attr("controls",!0).attr("width",o).attr("height",o/i.toFixed(2)),e("body").removeClass("loading"),e("video").css("opacity",1),e(window).resize(function(){var t=e("body").width();e("video").attr("width",t).attr("height",t/i.toFixed(2))}),void 0}return e(".video").css("width",a).css("height",window.screen.height/i.toFixed(2)),this.each(function(){var t=e(this)[0];if(/chrome|mozilla/i.test(navigator.userAgent)){var n=e(this).find("source[type='video/webm']");e(this).children().remove(),e(this).append(n)}else{var n=e(this).find("source[type='video/mp4']");/-small.mp4/i.test(n.src)&&(n.src=n.src.replace("-small.mp4",".mp4")),e(this).children().remove(),e(this).append(n)}t.load(),setTimeout(function(){e("body").removeClass("loading")},2500),t.addEventListener("loadeddata",function(){function t(){u.currentTime>=p&&(u.currentTime=0),w=d.find(".progress").width(),x(),d.find(".progress-bar").css({width:b+"px"});var e=b-d.find(".progress-button").width();0>e&&(e=0),d.find(".progress-button").css({left:e+"px"}),y()}var n=e(this),i=n.attr("data-width"),a=n.attr("data-height"),s=n.attr("data-intro"),o=n.attr("data-outro"),r=!1;300>=i||300>=a?(r=!0,n.wrap('<div class="video micro"></div>')):n.wrap('<div class="video"></div>'),r===!1&&""!=s&&e(".play-button").append("<div><span>"+s+"</span></div>");var d=n.parent(".video");e('<div class="play-button"></div><div class="player"><div class="pause-button"></div><div class="progress"><div class="progress-bar"><div class="progress-button"> </div></div></div><div class="time"><span class="ctime">00:00</span><span class="stime"> / </span><span class="ttime">00:00</span></div><div class="volume"><div class="volume-icon v-change-0"><span> </span></div></div><div class="fullscreen"><a href="#"> </a></div><div class="link"><a href="#"> </a></div></div>').appendTo(d),d.bind("selectstart",function(){return!1});var l,u=e(this)[0],p=u.duration,c=document.title,f=!1,v=!1,h=!1,m=!1,g=0,b=0,w=d.find(".progress").width(),y=function(){var t=u.buffered;if(d.find("[class^=buffered]").remove(),t.length>0)for(var n=t.length;n--;){$maxBuffer=t.end(n),$minBuffer=t.start(n);var i=100*($minBuffer/p),a=100*(($maxBuffer-$minBuffer)/p);e('<div class="buffered"></div>').css({left:i+"%",width:a+"%"}).appendTo(d.find(".progress"))}};y();var x=function(){var t=Math.round(e(".progress-bar").width()/w*p),n=u.currentTime,i=0,a=Math.floor(t/60),o=Math.floor(p/60),l=Math.round(p-60*o);t&&(i=Math.round(t)-60*a,i>59&&(i=Math.round(t)-60*a,60==i&&(a=Math.round(t/60),i=0))),b=n/p*w,10>i&&(i="0"+i),10>l&&(l="0"+l),d.find(".progress-bar").css({width:b+"px"});var f=b-d.find(".progress-button").width();0>f&&(f=0),d.find(".progress-button").css({left:f+"px"}),d.find(".ctime").html(a+":"+i),d.find(".ttime").html(o+":"+l),u.currentTime>0&&0==u.paused&&0==u.ended&&y(),document.title=h?"Playing "+a+":"+i+" / "+o+":"+l:u.currentTime>0?"Paused "+a+":"+i+" / "+o+":"+l:c,r===!1&&0>=n&&""!=s&&(0===e(".play-button div").length&&e(".play-button").append("<div><span></span></div>"),e(".play-button div span").text(s))};if(x(),u.addEventListener("timeupdate",x),e(window).resize(function(){t()}),r===!1)d.find(".player").css("opacity",1),setTimeout(function(){d.find(".player").css("opacity",0)},3e3);else{d.find(".player").css("display","none"),e(".play-button").append("<span></span>");var T=i/1.4;i>a&&(T=a/1.4),e(".play-button span").css("margin","-"+parseInt(T/2)+"px 0 0 -"+parseInt(T/2)+"px"),e(".play-button span").css({width:parseInt(T)+"px",height:parseInt(T)+"px"})}d.find(".play-button, .pause-button").on("click",function(){h=u.currentTime>0&&0==u.paused&&0==u.ended?!1:!0,0==h?(u.currentTime>0&&0==u.ended&&e(".play-button div").hide(),e(".play-button, .pause-button").removeClass("playing"),u.pause(),y()):(e(".play-button, .pause-button").addClass("playing"),m=!0,u.play())}),d.find(".progress").on("mousedown",function(e){f=!0,1==h&&u.pause(),g=e.pageX-d.find(".progress").offset().left,l=g/w*p,u.currentTime=l}),e("body, html").on("mousemove",function(t){var n=null;if(1!=r&&(d.on("mouseover",function(){clearTimeout(n),d.find(".player").css("opacity",1)}),d.on("mouseout",function(){n=setTimeout(function(){d.find(".player").css("opacity",0)},1e3)})),1==f){u.currentTime>0?e(".play-button div").hide(200):e(".play-button div").show(200),$draggingProgress=!0;var i=0;d.find(".progress-button").width(),g=t.pageX-d.find(".progress").offset().left,0>g?(i=0,u.currentTime=0):g>w?(u.currentTime=p,i=w):(i=g,l=g/w*p,u.currentTime=l),d.find(".progress-bar").css({width:i+"px"});var a=b-d.find(".progress-button").width();0>a&&(a=0),d.find(".progress-button").css({left:a+"px"})}}),u.addEventListener("playing",function(){t()}),u.addEventListener("ended",function(){h=!1,r===!1&&""!=o&&(0===e(".play-button div").length&&e(".play-button").append("<div><span></span></div>"),e(".play-button div span").text(o),e(".play-button div").show()),e(".play-button, .pause-button").removeClass("playing")}),d.find(".volume").on("click",function(){1==u.volume?(u.volume=0,d.find(".volume").addClass("off")):(u.volume=1,d.find(".volume").removeClass("off"))}),e("body, html").on("mouseup",function(){f=!1,v=!1,$draggingProgress=!1,1==h&&u.play(),y()}),u.requestFullscreen||u.mozRequestFullScreen||u.webkitRequestFullScreen||e(".fullscreen").hide(),e(".fullscreen").on("click",function(){u.requestFullscreen?u.requestFullscreen():u.mozRequestFullScreen?u.mozRequestFullScreen():u.webkitRequestFullScreen&&u.webkitRequestFullScreen()}),e(".link").on("click",function(){return window.location.href=window.location.href,!1})})})}}(jQuery);
